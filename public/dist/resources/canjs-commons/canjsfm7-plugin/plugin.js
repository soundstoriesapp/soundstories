define(["framework7","jquery","mtemplate!canjsfm7-plugin/pagebase.mustache","mtemplate!canjsfm7-plugin/pagenavbar.mustache","mtemplate!canjsfm7-plugin/popupnavbar.mustache"],function(e,n,a,o,p){Framework7.prototype.plugins.canjsPlugin=function(e,t){var r={};return e.openPage=function(e,o){var p={animatePages:!0,showBackLink:!0};o=can.extend(p,o),o.options.showBackLink=o.showBackLink,e.pageConfig=o,e.url="",o.content=a.render(),o.element=n('<div class="page-content"></div>');var t=new o.pageController(o.element,o.options);return t._preRenderPhase().done(function(){e.router.load(o)})},r.pageBeforeInit=function(e){var a=n(e.container),p=e.view.pageConfig;a.append(p.element);var r=a.find(".page-content").control(),i=n(e.navbarInnerContainer);if(r.navbar=i,r.renderNavbar)r.renderNavbar(i);else{var c=p.navbarTemplate||t.navbarTemplate||o;i.html(c(r.options))}r._postRenderPhase(),e.view.pageConfig=null},r.pageBeforeRemove=function(e){var a=n(e.container).find(".page-content"),o=a.control();o.destroy()},e.openPopup=function(n,a){var o=this,r={animatePages:!1,showBackLink:!1,navbarTemplate:t.popupNavbarTemplate||p};a=can.extend(r,a),e.openPage(n,a).done(function(){o.popup(".popup")})},n(".popup").on("closed",function(){n(".popup .navbar").html(""),n(".popup .pages").html("")}),{hooks:r}}});